{% extends '_full.html.twig' %}

{% set meta_title = 'Veranstaltungen' %}
{% set meta_subtitle = 'Übersicht' %}

{% set sidebar = 'events' %}

{% block page_header %}
<section class="py-3">
    <div class="container">

        {{ include('component/event_subbar.html.twig',{'selected':'index'}) }}

        <div class="mb-3">{{ include('component/_event_filter.html.twig') }}</div>

        <div class="row g-3">
            <div class="col-12">

                <div class="row row-cols-1 align-content-stretch mb-5">
                    <div class="col">
                        <div class="card">
                            <div class="card-body bg-white border-0 border-bottom border-primary">
                                <h3 class="h5 mb-0 text-center text-lg-start">Demnächst</h3>
                            </div>
                            <div class="list-group list-group-flush">
                                {% for post in posts|sort((a, b) => a.startDate <=> b.startDate) %}
                                    {% if post.endDate|date('Ymd') >= date('now')|date('Ymd')%}
                                        {{ include('component/_event_list.html.twig') }}
                                    {% endif %}
                                {% else %}
                                    <div class="list-group-item">
                                        Aktuell sind keine Meldungen vorhanden
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>

                </div>

                <div class="row row-cols-1 g-3 align-content-stretch">
                    <div class="col">
                        <div class="card card-body bg-white border-0 border-bottom border-primary">
                            <h3 class="h5 mb-0 text-center text-lg-start">Vorbei</h3>
                        </div>
                    </div>
                    <div class="list-group list-group-flush">
                        {% for post in posts|sort((a, b) => b.startDate <=> a.startDate) %}
                        {% if post.endDate|date('Ymd') <= date('-1 days')|date('Ymd')%}

                        {% endif %}
                        {% else %}
                        <div class="list-group-item">
                            Aktuell sind keine Meldungen vorhanden
                        </div>
                    </div>


                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}
{% block body %}


{% endblock %}

{% block aside %}

    <div class="d-none">
        <div class="fs-4 mb-1">Filtern nach ...</div>
        <a href="{{ url('event_index') }}" class="mb-3 d-block">Alle Veranstaltungen anzeigen</a>
        <div class="fs-5 fw-bolder mb-1">Veranstaltungsart</div>
        <div class="card border-primary">
            <div class="list-group list-group-flush">
                {% for type in types|sort((a, b) => b.events.count <=> a.events.count) %}
                    {% if type.events.count > 0 %}
                        {% if type.title in filtered_types %}
                            <div class="list-group-item  d-flex justify-content-between align-items-center py-3 active">
                                <span>{{ type.title }}</span><span class="badge text-bg-primary">{{ type.events.count }}</span>
                            </div>
                        {% else %}
                            <a href="{{ url('event_index',{'types': type.title ~ ',' ~ filtered_types|join(',')}) }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center py-3">
                                <span>{{ type.title }}</span><span class="badge text-bg-primary">{{ type.events.count }}</span>
                            </a>
                        {% endif %}

                    {% endif %}
                {% endfor %}
            </div>
        </div>
    </div>

{% endblock %}